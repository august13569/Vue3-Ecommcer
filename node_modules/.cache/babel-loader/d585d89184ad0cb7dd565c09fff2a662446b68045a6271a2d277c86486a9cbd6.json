{"ast":null,"code":"export default {\n  data() {\n    return {\n      carts: []\n    };\n  },\n  methods: {\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.$http.get(url).then(res => {\n        this.carts = res.data.data.carts;\n      });\n    },\n    handleNodeInserted(event) {\n      // 檢查是否出現role=\"dialog\"的元素\n      const dialogElement = event.target.querySelector('[role=\"dialog\"]');\n      if (dialogElement) {\n        // 出現符合條件的元素，向父層發送事件\n        this.$emit('showDialog', true);\n      } else {\n        this.$emit('showDialog', false);\n      }\n    }\n  },\n  computed: {\n    cartNum() {\n      return this.carts.length;\n    }\n  },\n  inject: ['emitter'],\n  mounted() {\n    this.$emitter.on('update-cart', newCartNum => {\n      this.carts = newCartNum;\n    });\n    const {\n      sidebar\n    } = this.$refs.sidebar;\n    if (sidebar) {\n      sidebar.addEventListener('DOMNodeInserted', this.handleNodeInserted);\n    }\n  },\n  beforeUnmount() {\n    // 移除事件監聽器，避免內存洩漏\n    const {\n      sidebar\n    } = this.$refs.sidebar;\n    if (sidebar) {\n      sidebar.removeEventListener('DOMNodeInserted', this.handleNodeInserted);\n    }\n  },\n  created() {\n    this.getCart();\n  }\n};","map":{"version":3,"names":["data","carts","methods","getCart","url","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","then","res","handleNodeInserted","event","dialogElement","target","querySelector","$emit","computed","cartNum","length","inject","mounted","$emitter","on","newCartNum","sidebar","$refs","addEventListener","beforeUnmount","removeEventListener","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\components\\Navbar.vue"],"sourcesContent":["<template>\n  <!-- Navbar -->\n  <nav class=\"navbar navbar-expand-lg sticky-top bg-white shadow\">\n    <div class=\"container\">\n      <!-- Toggle Btn -->\n      <button class=\"navbar-toggler\"\n              type=\"button\"\n              data-bs-toggle=\"offcanvas\"\n              data-bs-target=\"#offcanvasNavbar\"\n              aria-controls=\"offcanvasNavbar\"\n              >\n        <span class=\"navbar-toggler-icon\"></span>\n      </button>\n      <!-- Logo -->\n      <router-link to=\"/\" class=\"navbar-brand\">\n        <h1 class=\"visually-hidden\">BRITE</h1>\n        <img src=\"~@/assets/img/BRITE Logo.png\" alt=\"BRITE\" width=\"200\" height=\"60\">\n      </router-link>\n      <!-- Sidebar -->\n      <div class=\"offcanvas offcanvas-start\"\n           tabindex=\"-1\"\n           id=\"offcanvasNavbar\"\n           aria-labelledby=\"offcanvasNavbarLabel\"\n           data-bs-dismiss=\"offcanvas\"\n           ref=\"sidebar\"\n           >\n        <!-- Sidebar Header -->\n        <div class=\"offcanvas-header d-flex justify-content-end d-lg-none\">\n          <button class=\"btn-close text-reset\"\n                  type=\"button\"\n                  data-bs-dismiss=\"offcanvas\"\n                  aria-label=\"Close\"></button>\n        </div>\n        <!-- Sidebar Body -->\n        <div class=\"offcanvas-body\">\n          <ul class=\"navbar-nav justify-content-center flex-grow-1 pe-3\">\n            <li class=\"nav-item px-2\">\n              <router-link to=\"/\" class=\"nav-link link-secondary\"\n              hide.bs.offcanvas=\"offcanvas\">Home</router-link>\n            </li>\n            <li class=\"nav-item px-2\">\n              <router-link to=\"/about\" class=\"nav-link link-secondary\">About</router-link>\n            </li>\n            <li class=\"nav-item px-2\">\n              <router-link to=\"/products\" class=\"nav-link link-secondary\">Products</router-link>\n            </li>\n            <li class=\"nav-item px-2\">\n              <router-link to=\"/faq\" class=\"nav-link link-secondary\">FAQ</router-link>\n            </li>\n            <li class=\"nav-item px-2\">\n              <router-link to=\"/contact\" class=\"nav-link link-secondary\">Contact</router-link>\n            </li>\n          </ul>\n        </div>\n      </div>\n      <!-- Login / Shopping Cart -->\n      <div class=\"d-flex\">\n        <i class=\"bi bi-person-fill text-secondary fs-3 px-2\"></i>\n        <div class=\"position-relative align-self-center\">\n          <router-link to=\"/cart\" class=\"fs-5 px-2\">\n            <i class=\"bi bi-bag-fill text-secondary\"></i>\n          </router-link>\n          <span class=\"position-absolute top-0 start-100 translate-middle\n                       badge rounded-pill bg-danger\"\n                v-if=\"carts.length > 0\"\n                       >\n                       {{ cartNum }}\n            <span class=\"visually-hidden\">unread messages</span>\n          </span>\n        </div>\n      </div>\n    </div>\n  </nav>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      carts: [],\n    };\n  },\n  methods: {\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.$http.get(url).then((res) => {\n        this.carts = res.data.data.carts;\n      });\n    },\n    handleNodeInserted(event) {\n      // 檢查是否出現role=\"dialog\"的元素\n      const dialogElement = event.target.querySelector('[role=\"dialog\"]');\n      if (dialogElement) {\n        // 出現符合條件的元素，向父層發送事件\n        this.$emit('showDialog', true);\n      } else {\n        this.$emit('showDialog', false);\n      }\n    },\n  },\n  computed: {\n    cartNum() {\n      return this.carts.length;\n    },\n  },\n  inject: ['emitter'],\n  mounted() {\n    this.$emitter.on('update-cart', (newCartNum) => {\n      this.carts = newCartNum;\n    });\n    const { sidebar } = this.$refs.sidebar;\n    if (sidebar) {\n      sidebar.addEventListener('DOMNodeInserted', this.handleNodeInserted);\n    }\n  },\n  beforeUnmount() {\n    // 移除事件監聽器，避免內存洩漏\n    const { sidebar } = this.$refs.sidebar;\n    if (sidebar) {\n      sidebar.removeEventListener('DOMNodeInserted', this.handleNodeInserted);\n    }\n  },\n  created() {\n    this.getCart();\n  },\n};\n</script>\n"],"mappings":"AA4EA,eAAe;EACbA,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE;IACT,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,OAAOA,CAAA,EAAG;MACR,MAAMC,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,OAAM;MAC5E,IAAI,CAACC,KAAK,CAACC,GAAG,CAACN,GAAG,CAAC,CAACO,IAAI,CAAEC,GAAG,IAAK;QAChC,IAAI,CAACX,KAAI,GAAIW,GAAG,CAACZ,IAAI,CAACA,IAAI,CAACC,KAAK;MAClC,CAAC,CAAC;IACJ,CAAC;IACDY,kBAAkBA,CAACC,KAAK,EAAE;MACxB;MACA,MAAMC,aAAY,GAAID,KAAK,CAACE,MAAM,CAACC,aAAa,CAAC,iBAAiB,CAAC;MACnE,IAAIF,aAAa,EAAE;QACjB;QACA,IAAI,CAACG,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC;MAChC,OAAO;QACL,IAAI,CAACA,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC;MACjC;IACF;EACF,CAAC;EACDC,QAAQ,EAAE;IACRC,OAAOA,CAAA,EAAG;MACR,OAAO,IAAI,CAACnB,KAAK,CAACoB,MAAM;IAC1B;EACF,CAAC;EACDC,MAAM,EAAE,CAAC,SAAS,CAAC;EACnBC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,QAAQ,CAACC,EAAE,CAAC,aAAa,EAAGC,UAAU,IAAK;MAC9C,IAAI,CAACzB,KAAI,GAAIyB,UAAU;IACzB,CAAC,CAAC;IACF,MAAM;MAAEC;IAAQ,IAAI,IAAI,CAACC,KAAK,CAACD,OAAO;IACtC,IAAIA,OAAO,EAAE;MACXA,OAAO,CAACE,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAChB,kBAAkB,CAAC;IACtE;EACF,CAAC;EACDiB,aAAaA,CAAA,EAAG;IACd;IACA,MAAM;MAAEH;IAAQ,IAAI,IAAI,CAACC,KAAK,CAACD,OAAO;IACtC,IAAIA,OAAO,EAAE;MACXA,OAAO,CAACI,mBAAmB,CAAC,iBAAiB,EAAE,IAAI,CAAClB,kBAAkB,CAAC;IACzE;EACF,CAAC;EACDmB,OAAOA,CAAA,EAAG;IACR,IAAI,CAAC7B,OAAO,CAAC,CAAC;EAChB;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}