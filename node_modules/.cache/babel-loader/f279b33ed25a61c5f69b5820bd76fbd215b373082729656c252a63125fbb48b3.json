{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"table mt-4\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"購買時間\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Email\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"購買款項\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"應付金額\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"是否付款\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"編輯\")])], -1 /* HOISTED */);\nconst _hoisted_3 = [\"textContent\"];\nconst _hoisted_4 = {\n  class: \"list-unstyled\"\n};\nconst _hoisted_5 = {\n  class: \"text-right\"\n};\nconst _hoisted_6 = {\n  class: \"form-check form-switch\"\n};\nconst _hoisted_7 = [\"for\"];\nconst _hoisted_8 = [\"id\", \"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_9 = {\n  key: 0\n};\nconst _hoisted_10 = {\n  key: 1\n};\nconst _hoisted_11 = {\n  class: \"btn-group\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Loading = _resolveComponent(\"Loading\");\n  const _component_Pagination = _resolveComponent(\"Pagination\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_Loading, {\n    active: $data.isLoading\n  }, null, 8 /* PROPS */, [\"active\"]), _createElementVNode(\"table\", _hoisted_1, [_hoisted_2, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.orders, (item, key) => {\n    return _openBlock(), _createElementBlock(_Fragment, {\n      key: key\n    }, [$data.orders.length ? (_openBlock(), _createElementBlock(\"tr\", {\n      key: 0,\n      class: _normalizeClass({\n        'text-secondary': !item.is_paid\n      })\n    }, [_createElementVNode(\"td\", null, _toDisplayString(_ctx.$filters.date(item.create_at)), 1 /* TEXT */), _createElementVNode(\"td\", null, [item.user ? (_openBlock(), _createElementBlock(\"span\", {\n      key: 0,\n      textContent: _toDisplayString(item.user.email)\n    }, null, 8 /* PROPS */, _hoisted_3)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"td\", null, [_createElementVNode(\"ul\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.products, (product, i) => {\n      return _openBlock(), _createElementBlock(\"li\", {\n        key: i\n      }, _toDisplayString(product.product.title) + \" 數量：\" + _toDisplayString(product.qty) + \" \" + _toDisplayString(product.product.unit), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"td\", _hoisted_5, _toDisplayString(item.total), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"label\", {\n      class: \"form-check-label\",\n      for: `paidSwitch${item.id}`\n    }, [_withDirectives(_createElementVNode(\"input\", {\n      class: \"form-check-input\",\n      type: \"checkbox\",\n      id: `paidSwitch${item.id}`,\n      \"onUpdate:modelValue\": $event => item.is_paid = $event,\n      onChange: $event => $options.updatePaid(item)\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_8), [[_vModelCheckbox, item.is_paid]]), item.is_paid ? (_openBlock(), _createElementBlock(\"span\", _hoisted_9, \"已付款\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"未付款\"))], 8 /* PROPS */, _hoisted_7)])]), _createElementVNode(\"td\", null, [_createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"button\", {\n      class: \"btn btn-outline-primary btn-sm\",\n      onClick: $event => $options.openModal(false, item)\n    }, \"檢視\", 8 /* PROPS */, _hoisted_12), _createElementVNode(\"button\", {\n      class: \"btn btn-outline-danger btn-sm\",\n      onClick: $event => $options.openDelOrderModal(item)\n    }, \"刪除\", 8 /* PROPS */, _hoisted_13)])])], 2 /* CLASS */)) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createVNode(_component_Pagination, {\n    pages: $data.pagination,\n    onEmitPages: $options.getOrders\n  }, null, 8 /* PROPS */, [\"pages\", \"onEmitPages\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","_createVNode","_component_Loading","active","$data","isLoading","_hoisted_1","_hoisted_2","_createElementBlock","_Fragment","_renderList","orders","item","key","length","_normalizeClass","is_paid","_toDisplayString","_ctx","$filters","date","create_at","user","email","_hoisted_4","products","product","i","title","qty","unit","_hoisted_5","total","_hoisted_6","for","id","type","$event","onChange","$options","updatePaid","_hoisted_9","_hoisted_10","_hoisted_11","onClick","openModal","_hoisted_12","openDelOrderModal","_hoisted_13","_component_Pagination","pages","pagination","onEmitPages","getOrders"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\back\\Orders.vue"],"sourcesContent":["<!-- 是否付款、檢視、刪除 -->\n<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <table class=\"table mt-4\">\n    <thead>\n    <tr>\n      <th>購買時間</th>\n      <th>Email</th>\n      <th>購買款項</th>\n      <th>應付金額</th>\n      <th>是否付款</th>\n      <th>編輯</th>\n    </tr>\n    </thead>\n    <tbody>\n      <template v-for=\"(item, key) in orders\" :key=\"key\">\n        <tr v-if=\"orders.length\"\n            :class=\"{'text-secondary': !item.is_paid}\">\n          <td>{{ $filters.date(item.create_at) }}</td>\n          <td><span v-text=\"item.user.email\" v-if=\"item.user\"></span></td>\n          <td>\n            <ul class=\"list-unstyled\">\n              <li v-for=\"(product, i) in item.products\" :key=\"i\">\n                {{ product.product.title }} 數量：{{ product.qty }}\n                {{ product.product.unit }}\n              </li>\n            </ul>\n          </td>\n          <td class=\"text-right\">{{ item.total }}</td>\n          <td>\n            <div class=\"form-check form-switch\">\n              <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\n              <input class=\"form-check-input\" type=\"checkbox\" :id=\"`paidSwitch${item.id}`\"\n                     v-model=\"item.is_paid\"\n                     @change=\"updatePaid(item)\">\n                <span v-if=\"item.is_paid\">已付款</span>\n                <span v-else>未付款</span>\n              </label>\n            </div>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button class=\"btn btn-outline-primary btn-sm\"\n                      @click=\"openModal(false, item)\">檢視</button>\n              <button class=\"btn btn-outline-danger btn-sm\"\n                      @click=\"openDelOrderModal(item)\"\n              >刪除</button>\n            </div>\n          </td>\n        </tr>\n      </template>\n    </tbody>\n  </table>\n  <Pagination :pages=\"pagination\" @emit-pages=\"getOrders\"></Pagination>\n</template>\n\n<script>\nimport Pagination from '@/components/Pagination.vue';\n\nexport default {\n  data() {\n    return {\n      orders: {},\n      isNew: false,\n      pagination: {},\n      isLoading: false,\n      tempOrder: {},\n      currentPage: 1,\n    };\n  },\n  components: {\n    Pagination,\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.isLoading = true;\n      this.$http.get(url, this.tempProduct).then((response) => {\n        this.orders = response.data.orders;\n        this.pagination = response.data.pagination;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    openModal(isNew, item) {\n      this.tempOrder = { ...item };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.showModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = { ...item };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid,\n      };\n      this.$http.put(api, { data: paid }).then((response) => {\n        this.isLoading = false;\n        this.getOrders(this.currentPage);\n        this.$httpMessageState(response, '更新付款狀態');\n      });\n    },\n    delOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then((response) => {\n        console.log(response);\n        const delComponent = this.$refs.delModal;\n        delComponent.hideModal();\n        this.getOrders(this.currentPage);\n      });\n    },\n  },\n  created() {\n    this.getOrders();\n    console.log(process.env.VUE_APP_API);\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}