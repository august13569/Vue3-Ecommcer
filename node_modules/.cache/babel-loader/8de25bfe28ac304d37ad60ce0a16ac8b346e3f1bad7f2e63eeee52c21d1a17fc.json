{"ast":null,"code":"import Navbar from '@/components/Navbar.vue';\nimport Footer from '@/components/Footer.vue';\nimport Stepsbar from '@/components/StepsBar.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nexport default {\n  components: {\n    Navbar,\n    Footer,\n    Stepsbar,\n    ToastMessages,\n    DeleteModal\n  },\n  data() {\n    return {\n      stepsTitle: 'Cart',\n      status: {\n        loadingItem: ''\n      },\n      isLoading: false,\n      cart: {},\n      delItemId: ''\n    };\n  },\n  methods: {\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(url).then(res => {\n        this.cart = res.data.data;\n        console.log(this.cart);\n        this.isLoading = false;\n      });\n    },\n    updateQuantity(action, item) {\n      this.status.loadingItem = item.id;\n      const matchItems = this.cart.carts.filter(order => order.id === item.id);\n      matchItems.forEach(product => {\n        if (action === 'plus' && product.qty < product.product.is_enabled) {\n          product.qty += 1;\n          this.updateCart(item);\n        } else if (action === 'minus' && product.qty > 1) {\n          product.qty -= 1;\n          this.updateCart(item);\n        } else {\n          this.status.loadingItem = '';\n        }\n      });\n    },\n    updateCart(item) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      const cart = {\n        product_id: item.product_id,\n        qty: item.qty\n      };\n      this.$http.put(url, {\n        data: cart\n      }).then(res => {\n        console.log(res);\n        this.status.loadingItem = '';\n        this.getCart();\n      });\n    },\n    removeCartItem(delItemId) {\n      this.status.loadingItem = this.delItemId;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${this.delItemId}`;\n      this.$http.delete(url).then(res => {\n        console.log(res);\n        this.getCart();\n        this.updateCartNum();\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.'\n        });\n      });\n    },\n    updateCartNum() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.$http.get(url).then(res => {\n        const newCartNum = res.data.data.carts;\n        this.$emitter.emit('update-cart', newCartNum);\n      });\n    },\n    addCouponCode() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\n      const coupon = {\n        code: this.coupon_code\n      };\n      this.$http.post(url, {\n        data: coupon\n      }).then(res => {\n        console.log(res);\n        this.getCart();\n      });\n    }\n  },\n  created() {\n    this.getCart();\n  }\n};","map":{"version":3,"names":["Navbar","Footer","Stepsbar","ToastMessages","DeleteModal","components","data","stepsTitle","status","loadingItem","isLoading","cart","delItemId","methods","getCart","url","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","then","res","console","log","updateQuantity","action","item","id","matchItems","carts","filter","order","forEach","product","qty","is_enabled","updateCart","product_id","put","removeCartItem","delete","updateCartNum","$emitter","emit","style","title","newCartNum","addCouponCode","coupon","code","coupon_code","post","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\front\\ShoppingCart.vue"],"sourcesContent":["<!-- emitter可能要用全域註冊。由於元件的架構與原始課程不同，在ToastMessages調用時會undefined。 -->\n<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <ToastMessages></ToastMessages>\n  <DeleteModal @delete-item=\"removeCartItem\"></DeleteModal>\n  <Navbar></Navbar>\n  <Stepsbar class=\"my-4\" :title=\"stepsTitle\" v-if=\"cart && cart.carts && cart.carts.length > 0\">\n  </Stepsbar>\n  <!-- Shopping cart list -->\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col\" style=\"height: 60vh;\" v-if=\"cart && cart.carts && cart.carts.length > 0\">\n        <div class=\"table-responsive border rounded mb-3\">\n          <table class=\"table align-middle text-center mb-0\">\n            <thead>\n              <tr class=\"text-center\">\n                <th>Product</th>\n                <th>Name</th>\n                <th>Color</th>\n                <th>Price</th>\n                <th>Quantity</th>\n                <th>Total</th>\n                <th>Delete</th>\n              </tr>\n            </thead>\n            <tbody>\n              <template v-if=\"cart.carts\">\n                <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n                  <td>\n                    <img :src=\"`${item.product.imageUrl}`\" class=\"rounded\" alt=\"...\"\n                         style=\"max-width: 5rem;\">\n                  </td>\n                  <td>{{ item.product.title }}</td>\n                  <td>{{ item.product.unit }}</td>\n                  <td>${{ $filters.currency(item.product.price) }}</td>\n                  <td>\n                    <label for=\"buyqant\" class=\"d-inline-flex\">\n                      <button class=\"btn\"\n                              @click.prevent=\"updateQuantity('minus', item)\"\n                              :disabled=\"item.id === status.loadingItem\"\n                              >\n                        <i class=\"bi bi-dash-circle-fill link-primary fs-4\"></i>\n                      </button>\n                      <input class=\"q-input\"\n                             type=\"number\"\n                             name=\"buyqant\"\n                             id=\"buyqant\"\n                             value=\"0\"\n                             min=\"1\"\n                             v-model.number=\"item.qty\"\n                             :disabled=\"item.id === status.loadingItem\"\n                             >\n                      <button class=\"btn\"\n                              @click.prevent=\"updateQuantity('plus', item)\"\n                              :disabled=\"item.id === status.loadingItem\"\n                              >\n                        <i class=\"bi bi-plus-circle-fill link-primary fs-4\"></i>\n                      </button>\n                    </label>\n                    <br/>\n                    <span class=\"text-danger\" v-if=\"item.qty === item.product.is_enabled\">\n                      maximum\n                    </span>\n                  </td>\n                  <td>${{ $filters.currency(item.product.price * item.qty) }}</td>\n                  <td>\n                    <button type=\"button\" class=\"btn\"\n                            :disabled=\"status.loadingItem === item.id\"\n                            data-bs-toggle=\"modal\"\n                            data-bs-target=\"#deleteModal\"\n                            @click.prevent=\"this.delItemId = item.id\"\n                            >\n                            <!-- @click=\"removeCartItem(item.id)\" -->\n                      <i class=\"bi bi-trash link-danger fs-5\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </template>\n            </tbody>\n            <tfoot class=\"border-white\">\n              <tr>\n                <th colspan=\"4\">\n                  <input type=\"text\"\n                         class=\"form-control\"\n                         aria-label=\"text\"\n                         v-model=\"coupon_code\"\n                         placeholder=\"Please enter coupon code\"\n                         >\n                </th>\n                <td colspan=\"1\">\n                  <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"addCouponCode\">\n                    Apply\n                  </button>\n                </td>\n                <td :class=\"{ 'text-decoration-line-through': cart.total !== cart.final_total }\">\n                  Total: ${{ $filters.currency(cart.total) }}\n                </td>\n                <td class=\"fw-bold text-primary\" v-if=\"cart.total !== cart.final_total\">\n                  Discount: ${{ $filters.currency(cart.final_total) }}\n                </td>\n              </tr>\n            </tfoot>\n          </table>\n        </div>\n        <!-- Proceed buttons -->\n        <div class=\"d-flex justify-content-around mb-3\">\n          <router-link to=\"/products\">\n            <button class=\"btn btn-secondary\" type=\"button\">Back to Shopping</button>\n          </router-link>\n          <router-link to=\"/order\">\n            <button class=\"btn btn-primary text-white\" type=\"button\">Next Step</button>\n          </router-link>\n        </div>\n      </div>\n      <!-- Show when shopping cart empty -->\n      <div class=\"col text-center\" v-else>\n        <img class=\"img-fluid\" src=\"~@/assets/img/empty-cart.png\" alt=\"empty cart\">\n        <p class=\"fs-5 mb-1\">Your shopping cart is empty</p>\n        <p class=\"fs-5\">Let's fill it up</p>\n        <router-link to=\"/products\" role=\"button\"\n                     class=\"btn btn-primary btn-lg text-white mb-5\">\n                     Go shopping now\n        </router-link>\n      </div>\n    </div>\n  </div>\n  <Footer></Footer>\n</template>\n\n<script>\nimport Navbar from '@/components/Navbar.vue';\nimport Footer from '@/components/Footer.vue';\nimport Stepsbar from '@/components/StepsBar.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\n\nexport default {\n  components: {\n    Navbar,\n    Footer,\n    Stepsbar,\n    ToastMessages,\n    DeleteModal,\n  },\n  data() {\n    return {\n      stepsTitle: 'Cart',\n      status: {\n        loadingItem: '',\n      },\n      isLoading: false,\n      cart: {},\n      delItemId: '',\n    };\n  },\n  methods: {\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(url).then((res) => {\n        this.cart = res.data.data;\n        console.log(this.cart);\n        this.isLoading = false;\n      });\n    },\n    updateQuantity(action, item) {\n      this.status.loadingItem = item.id;\n      const matchItems = this.cart.carts.filter((order) => order.id === item.id);\n      matchItems.forEach((product) => {\n        if (action === 'plus' && product.qty < product.product.is_enabled) {\n          product.qty += 1;\n          this.updateCart(item);\n        } else if (action === 'minus' && product.qty > 1) {\n          product.qty -= 1;\n          this.updateCart(item);\n        } else {\n          this.status.loadingItem = '';\n        }\n      });\n    },\n    updateCart(item) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      const cart = {\n        product_id: item.product_id,\n        qty: item.qty,\n      };\n      this.$http.put(url, { data: cart })\n        .then((res) => {\n          console.log(res);\n          this.status.loadingItem = '';\n          this.getCart();\n        });\n    },\n    removeCartItem(delItemId) {\n      this.status.loadingItem = this.delItemId;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${this.delItemId}`;\n      this.$http.delete(url).then((res) => {\n        console.log(res);\n        this.getCart();\n        this.updateCartNum();\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.',\n        });\n      });\n    },\n    updateCartNum() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.$http.get(url).then((res) => {\n        const newCartNum = res.data.data.carts;\n        this.$emitter.emit('update-cart', newCartNum);\n      });\n    },\n    addCouponCode() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\n      const coupon = {\n        code: this.coupon_code,\n      };\n      this.$http.post(url, { data: coupon })\n        .then((res) => {\n          console.log(res);\n          this.getCart();\n        });\n    },\n  },\n  created() {\n    this.getCart();\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}