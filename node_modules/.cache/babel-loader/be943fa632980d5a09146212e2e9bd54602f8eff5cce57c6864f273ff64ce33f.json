{"ast":null,"code":"export default {\n  props: {\n    config: Object\n  },\n  data() {\n    return {\n      coupons: {},\n      tempCoupon: {\n        title: '',\n        is_enabled: 0,\n        percent: 100,\n        code: ''\n      },\n      isLoading: false,\n      isNew: false\n    };\n  },\n  methods: {\n    openCouponModal(isNew, item) {\n      this.isNew = isNew;\n      if (this.isNew) {\n        this.tempCoupon = {\n          due_date: new Date().getTime() / 1000\n        };\n      } else {\n        this.tempCoupon = {\n          ...item\n        };\n      }\n      this.$refs.couponModal.showModal();\n    },\n    openDelCouponModal(item) {\n      this.tempCoupon = {\n        ...item\n      };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    getCoupons() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons`;\n      this.$http.get(url, this.tempProduct).then(response => {\n        this.coupons = response.data.coupons;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    updateCoupon(tempCoupon) {\n      if (this.isNew) {\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`;\n        this.$http.post(url, {\n          data: tempCoupon\n        }).then(response => {\n          console.log(response, tempCoupon);\n          this.$httpMessageState(response, '新增優惠券');\n          this.getCoupons();\n          this.$refs.couponModal.hideModal();\n        });\n      } else {\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n        this.$http.put(url, {\n          data: this.tempCoupon\n        }).then(response => {\n          console.log(response);\n          this.$httpMessageState(response, '新增優惠券');\n          this.getCoupons();\n          this.$refs.couponModal.hideModal();\n        });\n      }\n    },\n    delCoupon() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then(response => {\n        console.log(response, this.tempCoupon);\n        this.$httpMessageState(response, '刪除優惠券');\n        const delComponent = this.$refs.delModal;\n        delComponent.hideModal();\n        this.getCoupons();\n      });\n    }\n  },\n  created() {\n    this.getCoupons();\n  }\n};","map":{"version":3,"names":["props","config","Object","data","coupons","tempCoupon","title","is_enabled","percent","code","isLoading","isNew","methods","openCouponModal","item","due_date","Date","getTime","$refs","couponModal","showModal","openDelCouponModal","delComponent","delModal","getCoupons","url","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","tempProduct","then","response","console","log","updateCoupon","post","$httpMessageState","hideModal","id","put","delCoupon","delete","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\back\\Coupons.vue"],"sourcesContent":["<!-- 新增優惠券、編輯、刪除 -->\n<template>\n  <div>\n    <Loading :active=\"isLoading\"></Loading>\n    <div class=\"text-end mt-4\">\n      <button class=\"btn btn-primary text-white\" type=\"button\" @click=\"openCouponModal(true)\">\n        建立新的優惠券\n      </button>\n    </div>\n    <table class=\"table mt-4\">\n      <thead>\n      <tr>\n        <th>名稱</th>\n        <th>折扣百分比</th>\n        <th>到期日</th>\n        <th>是否啟用</th>\n        <th>編輯</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr v-for=\"(item, key) in coupons\" :key=\"key\">\n        <td>{{ item.title }}</td>\n        <td>{{ item.percent }}%</td>\n        <td>{{ $filters.date(item.due_date) }}</td>\n        <td>\n          <span v-if=\"item.is_enabled === 1\" class=\"text-success\">啟用</span>\n          <span v-else class=\"text-muted\">未起用</span>\n        </td>\n        <td>\n          <div class=\"btn-group\">\n            <button class=\"btn btn-outline-primary btn-sm\"\n                    type=\"button\"\n                    @click=\"openCouponModal(false, item)\"\n            >編輯</button>\n            <button class=\"btn btn-outline-danger btn-sm\"\n                    type=\"button\"\n                    @click=\"openDelCouponModal(item)\"\n            >刪除</button>\n          </div>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n    <couponModal :coupon=\"tempCoupon\" ref=\"couponModal\"\n    @update-coupon=\"updateCoupon\"/>\n    <DelModal :item=\"tempCoupon\" ref=\"delModal\" @del-item=\"delCoupon\"/>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    config: Object,\n  },\n  data() {\n    return {\n      coupons: {},\n      tempCoupon: {\n        title: '',\n        is_enabled: 0,\n        percent: 100,\n        code: '',\n      },\n      isLoading: false,\n      isNew: false,\n    };\n  },\n  methods: {\n    openCouponModal(isNew, item) {\n      this.isNew = isNew;\n      if (this.isNew) {\n        this.tempCoupon = {\n          due_date: new Date().getTime() / 1000,\n        };\n      } else {\n        this.tempCoupon = { ...item };\n      }\n      this.$refs.couponModal.showModal();\n    },\n    openDelCouponModal(item) {\n      this.tempCoupon = { ...item };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    getCoupons() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons`;\n      this.$http.get(url, this.tempProduct).then((response) => {\n        this.coupons = response.data.coupons;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    updateCoupon(tempCoupon) {\n      if (this.isNew) {\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`;\n        this.$http.post(url, { data: tempCoupon }).then((response) => {\n          console.log(response, tempCoupon);\n          this.$httpMessageState(response, '新增優惠券');\n          this.getCoupons();\n          this.$refs.couponModal.hideModal();\n        });\n      } else {\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n        this.$http.put(url, { data: this.tempCoupon }).then((response) => {\n          console.log(response);\n          this.$httpMessageState(response, '新增優惠券');\n          this.getCoupons();\n          this.$refs.couponModal.hideModal();\n        });\n      }\n    },\n    delCoupon() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then((response) => {\n        console.log(response, this.tempCoupon);\n        this.$httpMessageState(response, '刪除優惠券');\n        const delComponent = this.$refs.delModal;\n        delComponent.hideModal();\n        this.getCoupons();\n      });\n    },\n  },\n  created() {\n    this.getCoupons();\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}