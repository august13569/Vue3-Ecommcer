{"ast":null,"code":"import BackPagination from '@/components/BackPagination.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport OrderModal from '@/components/OrderModal.vue';\nexport default {\n  data() {\n    return {\n      orders: {},\n      isNew: false,\n      pagination: {},\n      isLoading: false,\n      tempOrder: {},\n      currentPage: 1,\n      delItemId: ''\n    };\n  },\n  components: {\n    BackPagination,\n    DeleteModal,\n    ToastMessages,\n    OrderModal\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.isLoading = true;\n      this.$http.get(url, this.tempProduct).then(response => {\n        this.orders = response.data.orders;\n        this.pagination = response.data.pagination;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    openModal(isNew, item) {\n      this.tempOrder = {\n        ...item\n      };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.showModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = {\n        ...item\n      };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid\n      };\n      this.$http.put(api, {\n        data: paid\n      }).then(res => {\n        this.isLoading = false;\n        this.getOrders(this.currentPage);\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The statement has been changed'\n        });\n      });\n    },\n    deletOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.delItemId}`;\n      this.isLoading = true;\n      this.$http.delete(url).then(res => {\n        this.isLoading = false;\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.'\n        });\n        this.getOrders(this.currentPage);\n      });\n    }\n  },\n  created() {\n    this.getOrders();\n    console.log(process.env.VUE_APP_API);\n  }\n};","map":{"version":3,"names":["BackPagination","DeleteModal","ToastMessages","OrderModal","data","orders","isNew","pagination","isLoading","tempOrder","currentPage","delItemId","components","methods","getOrders","url","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","tempProduct","then","response","console","log","openModal","item","orderComponent","$refs","orderModal","showModal","openDelOrderModal","delComponent","delModal","updatePaid","api","id","paid","is_paid","put","res","$emitter","emit","style","title","deletOrder","delete","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\back\\Orders.vue"],"sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <ToastMessages />\n  <DeleteModal @delete-item=\"deletOrder\"></DeleteModal>\n  <OrderModal :order=\"tempOrder\" ref=\"orderModal\"></OrderModal>\n  <div class=\"table-responsive n-sbar\">\n    <table class=\"table mt-4\">\n      <thead>\n      <tr>\n        <th>購買時間</th>\n        <th>Email</th>\n        <th>購買款項</th>\n        <th>應付金額</th>\n        <th>是否付款</th>\n        <th>編輯</th>\n      </tr>\n      </thead>\n      <tbody>\n        <template v-for=\"(item, key) in orders\" :key=\"key\">\n          <tr v-if=\"orders.length\"\n              :class=\"{'text-secondary': !item.is_paid}\">\n            <td>{{ $filters.date(item.create_at) }}</td>\n            <td><span v-text=\"item.user.email\" v-if=\"item.user\"></span></td>\n            <td>\n              <ul class=\"list-unstyled\">\n                <li v-for=\"(product, i) in item.products\" :key=\"i\">\n                  {{ product.product.title }} 數量：{{ product.qty }}\n                  {{ product.product.unit }}\n                </li>\n              </ul>\n            </td>\n            <td class=\"text-right\">{{ item.total }}</td>\n            <td>\n              <div class=\"form-check form-switch\">\n                <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\n                <input class=\"form-check-input\" type=\"checkbox\" :id=\"`paidSwitch${item.id}`\"\n                       v-model=\"item.is_paid\"\n                       @change=\"updatePaid(item)\">\n                  <span v-if=\"item.is_paid\">已付款</span>\n                  <span v-else>未付款</span>\n                </label>\n              </div>\n            </td>\n            <td>\n              <div class=\"btn-group\">\n                <button class=\"btn btn-outline-primary btn-sm\"\n                        type=\"button\"\n                        @click=\"openModal(false, item)\">檢視</button>\n                <button class=\"btn btn-outline-danger btn-sm\"\n                        type=\"button\"\n                        data-bs-toggle=\"modal\"\n                        data-bs-target=\"#deleteModal\"\n                        @click=\"this.delItemId = item.id\"\n                >刪除</button>\n              </div>\n            </td>\n          </tr>\n        </template>\n      </tbody>\n    </table>\n  </div>\n  <BackPagination :pages=\"pagination\" @emit-pages=\"getOrders\"></BackPagination>\n</template>\n\n<script>\nimport BackPagination from '@/components/BackPagination.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport OrderModal from '@/components/OrderModal.vue';\n\nexport default {\n  data() {\n    return {\n      orders: {},\n      isNew: false,\n      pagination: {},\n      isLoading: false,\n      tempOrder: {},\n      currentPage: 1,\n      delItemId: '',\n    };\n  },\n  components: {\n    BackPagination,\n    DeleteModal,\n    ToastMessages,\n    OrderModal,\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.isLoading = true;\n      this.$http.get(url, this.tempProduct).then((response) => {\n        this.orders = response.data.orders;\n        this.pagination = response.data.pagination;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    openModal(isNew, item) {\n      this.tempOrder = { ...item };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.showModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = { ...item };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid,\n      };\n      this.$http.put(api, { data: paid }).then((res) => {\n        this.isLoading = false;\n        this.getOrders(this.currentPage);\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The statement has been changed',\n        });\n      });\n    },\n    deletOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.delItemId}`;\n      this.isLoading = true;\n      this.$http.delete(url).then((res) => {\n        this.isLoading = false;\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.',\n        });\n        this.getOrders(this.currentPage);\n      });\n    },\n  },\n  created() {\n    this.getOrders();\n    console.log(process.env.VUE_APP_API);\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}