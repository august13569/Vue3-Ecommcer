{"ast":null,"code":"import ProductModal from '@/components/ProductModal.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport BackPagination from '@/components/BackPagination.vue';\nexport default {\n  components: {\n    DeleteModal,\n    ProductModal,\n    ToastMessages,\n    BackPagination\n  },\n  data() {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {},\n      delItemId: '',\n      isNew: false,\n      isLoading: false\n    };\n  },\n  methods: {\n    getProducts(page = 1) {\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/products/?page=${page}`;\n      this.isLoading = true;\n      this.$http.get(api).then(res => {\n        if (res.data.success) {\n          console.log(res.data);\n          this.products = res.data.products;\n          this.pagination = res.data.pagination;\n        }\n        this.isLoading = false;\n      });\n    },\n    openModal(isNew, item) {\n      if (isNew) {\n        this.tempProduct = {};\n      } else {\n        this.tempProduct = {\n          ...item\n        };\n      }\n      this.isNew = isNew;\n      const productComponent = this.$refs.productModal;\n      productComponent.showModal();\n    },\n    updateProduct(item) {\n      this.tempProduct = item;\n      let api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product`;\n      let httpMethod = 'post';\n      if (!this.isNew) {\n        api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${item.id}`;\n        httpMethod = 'put';\n      }\n      const productComponent = this.$refs.productModal;\n      this.$http[httpMethod](api, {\n        data: this.tempProduct\n      }).then(res => {\n        console.log(res);\n        productComponent.hideModal();\n        if (res.data.success) {\n          this.getProducts();\n          this.$emitter.emit('push-message', {\n            style: 'primary',\n            title: 'The item has been updated'\n          });\n        } else {\n          this.$emitter.emit('push-message', {\n            style: 'danger',\n            title: 'The item has failed to update'\n          });\n        }\n      });\n    },\n    removeCartItem() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${this.delItemId}`;\n      this.$http.delete(url).then(res => {\n        console.log(res.data);\n        this.isLoading = false;\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.'\n        });\n        this.getProducts();\n      });\n    }\n  },\n  created() {\n    this.getProducts();\n  }\n};","map":{"version":3,"names":["ProductModal","DeleteModal","ToastMessages","BackPagination","components","data","products","pagination","tempProduct","delItemId","isNew","isLoading","methods","getProducts","page","api","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","then","res","success","console","log","openModal","item","productComponent","$refs","productModal","showModal","updateProduct","httpMethod","id","hideModal","$emitter","emit","style","title","removeCartItem","url","delete","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\back\\Products.vue"],"sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <ToastMessages />\n  <DeleteModal @delete-item=\"removeCartItem\"></DeleteModal>\n  <div class=\"text-end m-3 mb-0\">\n    <button class=\"btn btn-primary text-white\"\n            type=\"button\"\n            @click=\"openModal(true)\"\n            >增加一個產品</button>\n  </div>\n  <div class=\"table-responsive n-sbar\">\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th width=\"120\">分類</th>\n          <th>產品名稱</th>\n          <th width=\"120\">原價</th>\n          <th width=\"120\">售價</th>\n          <th width=\"120\">庫存</th>\n          <th width=\"100\">是否啟用</th>\n          <th width=\"200\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in products\" :key=\"item.id\">\n          <td>{{ item.category}}</td>\n          <td>{{ item.title }}</td>\n          <td class=\"text-right\">\n            {{ $filters.currency(item.origin_price) }}\n          </td>\n          <td class=\"text-right\">\n            {{ $filters.currency(item.price) }}\n          </td>\n          <td class=\"text-right\">\n            {{ $filters.currency(item.is_enabled) }}\n          </td>\n          <td>\n            <span class=\"text-success\" v-if=\"item.is_enabled\">啟用</span>\n            <span class=\"text-muted\" v-else>未啟用</span>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button class=\"btn btn-outline-primary btn-sm\"\n                      type=\"button\"\n                      @click=\"openModal(false, item)\">編輯</button>\n              <button class=\"btn btn-outline-danger btn-sm\"\n                      type=\"button\"\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#deleteModal\"\n                      @click=\"this.delItemId = item.id\">刪除</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <BackPagination :pages=\"pagination\" @emit-pages=\"getProducts\"></BackPagination>\n  <ProductModal\n    ref=\"productModal\" :product=\"tempProduct\" @update-product=\"updateProduct\">\n  </ProductModal>\n</template>\n\n<script>\nimport ProductModal from '@/components/ProductModal.vue';\nimport DeleteModal from '@/components/DeleteModal.vue';\nimport ToastMessages from '@/components/ToastMessages.vue';\nimport BackPagination from '@/components/BackPagination.vue';\n\nexport default {\n  components: {\n    DeleteModal,\n    ProductModal,\n    ToastMessages,\n    BackPagination,\n  },\n  data() {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {},\n      delItemId: '',\n      isNew: false,\n      isLoading: false,\n    };\n  },\n  methods: {\n    getProducts(page = 1) {\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/products/?page=${page}`;\n      this.isLoading = true;\n      this.$http.get(api)\n        .then((res) => {\n          if (res.data.success) {\n            console.log(res.data);\n            this.products = res.data.products;\n            this.pagination = res.data.pagination;\n          }\n          this.isLoading = false;\n        });\n    },\n    openModal(isNew, item) {\n      if (isNew) {\n        this.tempProduct = {};\n      } else {\n        this.tempProduct = { ...item };\n      }\n      this.isNew = isNew;\n      const productComponent = this.$refs.productModal;\n      productComponent.showModal();\n    },\n    updateProduct(item) {\n      this.tempProduct = item;\n      let api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product`;\n      let httpMethod = 'post';\n      if (!this.isNew) {\n        api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${item.id}`;\n        httpMethod = 'put';\n      }\n      const productComponent = this.$refs.productModal;\n      this.$http[httpMethod](api, { data: this.tempProduct })\n        .then((res) => {\n          console.log(res);\n          productComponent.hideModal();\n          if (res.data.success) {\n            this.getProducts();\n            this.$emitter.emit('push-message', {\n              style: 'primary',\n              title: 'The item has been updated',\n            });\n          } else {\n            this.$emitter.emit('push-message', {\n              style: 'danger',\n              title: 'The item has failed to update',\n            });\n          }\n        });\n    },\n    removeCartItem() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${this.delItemId}`;\n      this.$http.delete(url).then((res) => {\n        console.log(res.data);\n        this.isLoading = false;\n        this.$emitter.emit('push-message', {\n          style: 'primary',\n          title: 'The item has been removed.',\n        });\n        this.getProducts();\n      });\n    },\n  },\n  created() {\n    this.getProducts();\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}