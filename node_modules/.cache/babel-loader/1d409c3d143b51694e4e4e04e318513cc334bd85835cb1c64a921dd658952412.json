{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      products: [],\n      product: {},\n      status: {\n        loadingItem: ''\n      },\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: ''\n        },\n        message: ''\n      },\n      cart: {},\n      coupon_code: ''\n    };\n  },\n  methods: {\n    getProducts() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/products/all`;\n      this.isLoading = true;\n      this.$http.get(url).then(res => {\n        this.products = res.data.products;\n        console.log('products:', res);\n        this.isLoading = false;\n      });\n    },\n    getProduct(id) {\n      this.$router.push(`/user/product/${id}`);\n    },\n    addCart(id) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.status.loadingItem = id;\n      const cart = {\n        product_id: id,\n        qty: 1\n      };\n      this.$http.post(url, {\n        data: cart\n      }).then(res => {\n        this.status.loadingItem = '';\n        console.log(res);\n      });\n    },\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(url).then(res => {\n        console.log(res);\n        this.cart = res.data.data;\n        this.isLoading = false;\n      });\n    },\n    updateCart(item) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      this.isLoading = true;\n      this.status.loadingItem = item.id;\n      const cart = {\n        product_id: item.product_id,\n        qty: item.qty\n      };\n      this.$http.put(url, {\n        data: cart\n      }).then(res => {\n        console.log(res);\n        this.status.loadingItem = '';\n        this.getCart();\n      });\n    },\n    addCouponCode() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\n      const coupon = {\n        code: this.coupon_code\n      };\n      this.$http.post(url, {\n        data: coupon\n      }).then(res => {\n        console.log(res);\n        this.getCart();\n      });\n    },\n    createOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order`;\n      const order = this.form;\n      this.$http.post(url, {\n        data: order\n      }).then(res => {\n        console.log(res);\n      });\n    }\n  },\n  created() {\n    this.getProducts();\n    this.getCart();\n  }\n};","map":{"version":3,"names":["data","products","product","status","loadingItem","form","user","name","email","tel","address","message","cart","coupon_code","methods","getProducts","url","process","env","VUE_APP_API","VUE_APP_PATH","isLoading","$http","get","then","res","console","log","getProduct","id","$router","push","addCart","product_id","qty","post","getCart","updateCart","item","put","addCouponCode","coupon","code","createOrder","order","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\front\\ShoppingCart.vue"],"sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-8\">\n        <table class=\"table align-middle\">\n          <thead>\n            <tr>\n              <th></th>\n              <th>品名</th>\n              <th>數量</th>\n              <th>單價</th>\n            </tr>\n          </thead>\n          <tbody>\n          <template v-if=\"cart.carts\">\n            <tr v-for=\"item in cart.carts\" :key=\"item.id\">\n              <td>\n                <button type=\"button\" class=\"btn btn-outline-danger btn-sm\"\n                        :disabled=\"status.loadingItem === item.id\"\n                        @click=\"removeCartItem(item.id)\">\n                  <i class=\"bi bi-x\"></i>\n                </button>\n              </td>\n              <td>\n                {{ item.product.title }}\n                <div class=\"text-success\" v-if=\"item.coupon\">\n                  已套用優惠券\n                </div>\n              </td>\n              <td>\n                <div class=\"input-group input-group-sm\">\n                  <input type=\"number\" class=\"form-control text-center\" aria-label=\"number\"\n                        :disabled=\"item.id === status.loadingItem\"\n                        @change=\"updateCart(item)\"\n                        v-model.number=\"item.qty\" min=\"1\"\n                        style=\"width: 1.5rem;\"\n                        >\n                  <div class=\"input-group-text\">/ {{ item.product.unit }}</div>\n                </div>\n              </td>\n              <td class=\"text-end\">\n                <small v-if=\"cart.final_total !== cart.total\" class=\"text-success\">折扣價：</small>\n                {{ $filters.currency(item.final_total) }}\n              </td>\n            </tr>\n          </template>\n          </tbody>\n          <tfoot>\n          <tr>\n            <td colspan=\"3\" class=\"text-end\">總計</td>\n            <td class=\"text-end\">{{ $filters.currency(cart.total) }}</td>\n          </tr>\n          <tr v-if=\"cart.final_total !== cart.total\">\n            <td colspan=\"3\" class=\"text-end text-success\">折扣價</td>\n            <td class=\"text-end text-success\">{{ $filters.currency(cart.final_total) }}</td>\n          </tr>\n          </tfoot>\n        </table>\n      </div>\n      <div class=\"col-4\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      products: [],\n      product: {},\n      status: {\n        loadingItem: '',\n      },\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: '',\n        },\n        message: '',\n      },\n      cart: {},\n      coupon_code: '',\n    };\n  },\n  methods: {\n    getProducts() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/products/all`;\n      this.isLoading = true;\n      this.$http.get(url).then((res) => {\n        this.products = res.data.products;\n        console.log('products:', res);\n        this.isLoading = false;\n      });\n    },\n    getProduct(id) {\n      this.$router.push(`/user/product/${id}`);\n    },\n    addCart(id) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.status.loadingItem = id;\n      const cart = {\n        product_id: id,\n        qty: 1,\n      };\n      this.$http.post(url, { data: cart })\n        .then((res) => {\n          this.status.loadingItem = '';\n          console.log(res);\n        });\n    },\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(url).then((res) => {\n        console.log(res);\n        this.cart = res.data.data;\n        this.isLoading = false;\n      });\n    },\n    updateCart(item) {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      this.isLoading = true;\n      this.status.loadingItem = item.id;\n      const cart = {\n        product_id: item.product_id,\n        qty: item.qty,\n      };\n      this.$http.put(url, { data: cart })\n        .then((res) => {\n          console.log(res);\n          this.status.loadingItem = '';\n          this.getCart();\n        });\n    },\n    addCouponCode() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\n      const coupon = {\n        code: this.coupon_code,\n      };\n      this.$http.post(url, { data: coupon })\n        .then((res) => {\n          console.log(res);\n          this.getCart();\n        });\n    },\n    createOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order`;\n      const order = this.form;\n      this.$http.post(url, { data: order })\n        .then((res) => {\n          console.log(res);\n        });\n    },\n  },\n  created() {\n    this.getProducts();\n    this.getCart();\n  },\n};\n</script>\n"],"mappings":";AAkEA,eAAe;EACbA,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,OAAO,EAAE,CAAC,CAAC;MACXC,MAAM,EAAE;QACNC,WAAW,EAAE;MACf,CAAC;MACDC,IAAI,EAAE;QACJC,IAAI,EAAE;UACJC,IAAI,EAAE,EAAE;UACRC,KAAK,EAAE,EAAE;UACTC,GAAG,EAAE,EAAE;UACPC,OAAO,EAAE;QACX,CAAC;QACDC,OAAO,EAAE;MACX,CAAC;MACDC,IAAI,EAAE,CAAC,CAAC;MACRC,WAAW,EAAE;IACf,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,WAAWA,CAAA,EAAG;MACZ,MAAMC,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,eAAc;MACpF,IAAI,CAACC,SAAQ,GAAI,IAAI;MACrB,IAAI,CAACC,KAAK,CAACC,GAAG,CAACP,GAAG,CAAC,CAACQ,IAAI,CAAEC,GAAG,IAAK;QAChC,IAAI,CAACxB,QAAO,GAAIwB,GAAG,CAACzB,IAAI,CAACC,QAAQ;QACjCyB,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEF,GAAG,CAAC;QAC7B,IAAI,CAACJ,SAAQ,GAAI,KAAK;MACxB,CAAC,CAAC;IACJ,CAAC;IACDO,UAAUA,CAACC,EAAE,EAAE;MACb,IAAI,CAACC,OAAO,CAACC,IAAI,CAAE,iBAAgBF,EAAG,EAAC,CAAC;IAC1C,CAAC;IACDG,OAAOA,CAACH,EAAE,EAAE;MACV,MAAMb,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,OAAM;MAC5E,IAAI,CAACjB,MAAM,CAACC,WAAU,GAAIyB,EAAE;MAC5B,MAAMjB,IAAG,GAAI;QACXqB,UAAU,EAAEJ,EAAE;QACdK,GAAG,EAAE;MACP,CAAC;MACD,IAAI,CAACZ,KAAK,CAACa,IAAI,CAACnB,GAAG,EAAE;QAAEhB,IAAI,EAAEY;MAAK,CAAC,EAChCY,IAAI,CAAEC,GAAG,IAAK;QACb,IAAI,CAACtB,MAAM,CAACC,WAAU,GAAI,EAAE;QAC5BsB,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAClB,CAAC,CAAC;IACN,CAAC;IACDW,OAAOA,CAAA,EAAG;MACR,MAAMpB,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,OAAM;MAC5E,IAAI,CAACC,SAAQ,GAAI,IAAI;MACrB,IAAI,CAACC,KAAK,CAACC,GAAG,CAACP,GAAG,CAAC,CAACQ,IAAI,CAAEC,GAAG,IAAK;QAChCC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChB,IAAI,CAACb,IAAG,GAAIa,GAAG,CAACzB,IAAI,CAACA,IAAI;QACzB,IAAI,CAACqB,SAAQ,GAAI,KAAK;MACxB,CAAC,CAAC;IACJ,CAAC;IACDgB,UAAUA,CAACC,IAAI,EAAE;MACf,MAAMtB,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,SAAQkB,IAAI,CAACT,EAAG,EAAC;MACvF,IAAI,CAACR,SAAQ,GAAI,IAAI;MACrB,IAAI,CAAClB,MAAM,CAACC,WAAU,GAAIkC,IAAI,CAACT,EAAE;MACjC,MAAMjB,IAAG,GAAI;QACXqB,UAAU,EAAEK,IAAI,CAACL,UAAU;QAC3BC,GAAG,EAAEI,IAAI,CAACJ;MACZ,CAAC;MACD,IAAI,CAACZ,KAAK,CAACiB,GAAG,CAACvB,GAAG,EAAE;QAAEhB,IAAI,EAAEY;MAAK,CAAC,EAC/BY,IAAI,CAAEC,GAAG,IAAK;QACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChB,IAAI,CAACtB,MAAM,CAACC,WAAU,GAAI,EAAE;QAC5B,IAAI,CAACgC,OAAO,CAAC,CAAC;MAChB,CAAC,CAAC;IACN,CAAC;IACDI,aAAaA,CAAA,EAAG;MACd,MAAMxB,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,SAAQ;MAC9E,MAAMqB,MAAK,GAAI;QACbC,IAAI,EAAE,IAAI,CAAC7B;MACb,CAAC;MACD,IAAI,CAACS,KAAK,CAACa,IAAI,CAACnB,GAAG,EAAE;QAAEhB,IAAI,EAAEyC;MAAO,CAAC,EAClCjB,IAAI,CAAEC,GAAG,IAAK;QACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChB,IAAI,CAACW,OAAO,CAAC,CAAC;MAChB,CAAC,CAAC;IACN,CAAC;IACDO,WAAWA,CAAA,EAAG;MACZ,MAAM3B,GAAE,GAAK,GAAEC,OAAO,CAACC,GAAG,CAACC,WAAY,OAAMF,OAAO,CAACC,GAAG,CAACE,YAAa,QAAO;MAC7E,MAAMwB,KAAI,GAAI,IAAI,CAACvC,IAAI;MACvB,IAAI,CAACiB,KAAK,CAACa,IAAI,CAACnB,GAAG,EAAE;QAAEhB,IAAI,EAAE4C;MAAM,CAAC,EACjCpB,IAAI,CAAEC,GAAG,IAAK;QACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAClB,CAAC,CAAC;IACN;EACF,CAAC;EACDoB,OAAOA,CAAA,EAAG;IACR,IAAI,CAAC9B,WAAW,CAAC,CAAC;IAClB,IAAI,CAACqB,OAAO,CAAC,CAAC;EAChB;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}