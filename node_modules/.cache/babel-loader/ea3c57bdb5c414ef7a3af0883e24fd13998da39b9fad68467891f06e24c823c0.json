{"ast":null,"code":"import Pagination from '@/components/Pagination.vue';\nexport default {\n  data() {\n    return {\n      orders: {},\n      isNew: false,\n      pagination: {},\n      isLoading: false,\n      tempOrder: {},\n      currentPage: 1\n    };\n  },\n  components: {\n    Pagination\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.isLoading = true;\n      this.$http.get(url, this.tempProduct).then(response => {\n        this.orders = response.data.orders;\n        this.pagination = response.data.pagination;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    openModal(isNew, item) {\n      this.tempOrder = {\n        ...item\n      };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.showModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = {\n        ...item\n      };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid\n      };\n      this.$http.put(api, {\n        data: paid\n      }).then(response => {\n        this.isLoading = false;\n        this.getOrders(this.currentPage);\n        this.$httpMessageState(response, '更新付款狀態');\n      });\n    },\n    delOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then(response => {\n        console.log(response);\n        const delComponent = this.$refs.delModal;\n        delComponent.hideModal();\n        this.getOrders(this.currentPage);\n      });\n    }\n  },\n  created() {\n    this.getOrders();\n    console.log(process.env.VUE_APP_API);\n  }\n};","map":{"version":3,"names":["Pagination","data","orders","isNew","pagination","isLoading","tempOrder","currentPage","components","methods","getOrders","url","process","env","VUE_APP_API","VUE_APP_PATH","$http","get","tempProduct","then","response","console","log","openModal","item","orderComponent","$refs","orderModal","showModal","openDelOrderModal","delComponent","delModal","updatePaid","api","id","paid","is_paid","put","$httpMessageState","delOrder","delete","hideModal","created"],"sources":["C:\\Users\\augus\\OneDrive\\桌面\\暫存區\\vue-practice\\brite\\src\\views\\back\\Orders.vue"],"sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <table class=\"table mt-4\">\n    <thead>\n    <tr>\n      <th>購買時間</th>\n      <th>Email</th>\n      <th>購買款項</th>\n      <th>應付金額</th>\n      <th>是否付款</th>\n      <th>編輯</th>\n    </tr>\n    </thead>\n    <tbody>\n      <template v-for=\"(item, key) in orders\" :key=\"key\">\n        <tr v-if=\"orders.length\"\n            :class=\"{'text-secondary': !item.is_paid}\">\n          <td>{{ $filters.date(item.create_at) }}</td>\n          <td><span v-text=\"item.user.email\" v-if=\"item.user\"></span></td>\n          <td>\n            <ul class=\"list-unstyled\">\n              <li v-for=\"(product, i) in item.products\" :key=\"i\">\n                {{ product.product.title }} 數量：{{ product.qty }}\n                {{ product.product.unit }}\n              </li>\n            </ul>\n          </td>\n          <td class=\"text-right\">{{ item.total }}</td>\n          <td>\n            <div class=\"form-check form-switch\">\n              <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\n              <input class=\"form-check-input\" type=\"checkbox\" :id=\"`paidSwitch${item.id}`\"\n                     v-model=\"item.is_paid\"\n                     @change=\"updatePaid(item)\">\n                <span v-if=\"item.is_paid\">已付款</span>\n                <span v-else>未付款</span>\n              </label>\n            </div>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button class=\"btn btn-outline-primary btn-sm\"\n                      @click=\"openModal(false, item)\">檢視</button>\n              <button class=\"btn btn-outline-danger btn-sm\"\n                      @click=\"openDelOrderModal(item)\"\n              >刪除</button>\n            </div>\n          </td>\n        </tr>\n      </template>\n    </tbody>\n  </table>\n  <Pagination :pages=\"pagination\" @emit-pages=\"getOrders\"></Pagination>\n</template>\n\n<script>\nimport Pagination from '@/components/Pagination.vue';\n\nexport default {\n  data() {\n    return {\n      orders: {},\n      isNew: false,\n      pagination: {},\n      isLoading: false,\n      tempOrder: {},\n      currentPage: 1,\n    };\n  },\n  components: {\n    Pagination,\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.isLoading = true;\n      this.$http.get(url, this.tempProduct).then((response) => {\n        this.orders = response.data.orders;\n        this.pagination = response.data.pagination;\n        this.isLoading = false;\n        console.log(response);\n      });\n    },\n    openModal(isNew, item) {\n      this.tempOrder = { ...item };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.showModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = { ...item };\n      const delComponent = this.$refs.delModal;\n      delComponent.showModal();\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid,\n      };\n      this.$http.put(api, { data: paid }).then((response) => {\n        this.isLoading = false;\n        this.getOrders(this.currentPage);\n        this.$httpMessageState(response, '更新付款狀態');\n      });\n    },\n    delOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then((response) => {\n        console.log(response);\n        const delComponent = this.$refs.delModal;\n        delComponent.hideModal();\n        this.getOrders(this.currentPage);\n      });\n    },\n  },\n  created() {\n    this.getOrders();\n    console.log(process.env.VUE_APP_API);\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}